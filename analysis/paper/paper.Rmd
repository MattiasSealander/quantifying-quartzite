---
title: "Semi-quantitative petrographic characterization of Bronze Age quartzite tools – a multivariate approach"
author:
  - Mattias Sjölander:
      email: mattias.sjolander@umu.se
      institute: [UmU]
      correspondence: true
institute:
  - UmU: Umeå University
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::word_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
      pandoc_args:
      - --lua-filter=../templates/scholarly-metadata.lua
      - --lua-filter=../templates/author-info-blocks.lua
      - --lua-filter=../templates/pagebreak.lua
mainfont: Times New Roman
bibliography: references.bib
csl: "../templates/journal-of-archaeological-and-anthropological-science.csl" # Insert path for the bib-style
abstract: |
  Text of abstract
keywords: |
  Spectroscopy; Quartzite; Characterization; Lithics
highlights: |
  These are the highlights. 
---

<!-- This is the format for text comments that will be ignored during renderings. Do not put R code in these comments because it will not be ignored. -->

<!-- With the following code you can access and display values from the yml header above. -->

Keywords: `r rmarkdown::metadata$keywords`

Highlights: `r rmarkdown::metadata$highlights`

<!-- The following code chunk defines some general settings how code chunks should behave. -->

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figures/",
  dpi = 300
)
```

```{r load-packages-and-data}
library(tidyverse)
library(ggplot2)
library(gridExtra)
library(ggsci)

#Import xrf data
XRF.csv <-
read.csv2("C:/Users//masj0062/Documents/DOKTORANDSPROJEKT/VERSION CONTROL/MethodPaper/analysis/data/raw_data//XRF/XRF_quantitative.csv", sep = ";", dec = ".", header = TRUE)

#Import sample list, set empty fields to NA
samples <-
  as.data.frame(read.csv2("C:/Users//masj0062/Documents/DOKTORANDSPROJEKT/VERSION CONTROL/MethodPaper/analysis/data/raw_data//bifacial_points.csv", sep = ";", dec = ".", header = TRUE, na.strings=c("", "NA")))

#Filter data to focus on quartzite points, point fragments and preforms made from quartz/quartzite materials
Points <-
  XRF.csv %>%
  filter(material == "Quartz" | material == "Quartzite" | material == "Breccie quartz" | material == "Breccie quartzite" | material  == "Felsitic porphyric quartz",
         type == "Point" | type == "Point fragment" | type == "Preform")

#Import loadings from Evince
loadings <-
 as.data.frame(read.csv2("C:/Users//masj0062/Documents/DOKTORANDSPROJEKT/VERSION CONTROL/MethodPaper/analysis/data/raw_data/XRF/XRF_P_values.csv", sep = ";", dec = ".", header = TRUE, encoding = "UTF-8"))
```
<!-- The actual document text starts here: -->

# Introduction

In European archaeology provenience studies and petrographic characterization has for some time favoured flint and obsidian over other geological materials [@prieto_etal20 p.32]. However, in regions where local flint and obsidian sources are non-existent other materials have taken on the dominant role. In Northern Fennoscandia these include quartz, quartzite and slate  [@baudou78; @rankama_etal06; @olausson_etal12], and while both quartz and quartzite technology have been the target of a number of studies over the years there have been less development in the petrographic characterization and provenience studies of these same materials [@broadbent79; @callahan_etal92; @knutsson_etal16; @tallavaara_etal10].

One reason for the lack of methodological development could be the geological background of the region and the abundance of moraine formations [@bargel03; @stephens_bergmanweihed20; @stroeven_etal16]. The degree to which geological materials have been mixed and transported means that considerable effort is needed in order to reconstruct the events that have formed the modern day landscape. Both quartz and quartzite could potentially have been sourced by local prehistoric groups from exposed veins in the bedrock, or as loose rocks and pebbles in the numerous moraine formations [@rankama_etal06]. Due to this ambigous nature of availability of raw materials it is difficult to model sourcing strategies for groups that were based within this region. 
[@prieto_etal19 p.15; @prieto_etal20 p.32] notes that ‘quartzite’ represents a somewhat ambiguous term in archaeology, where it is often used interchangeably between sedimentary orthoquartzite and metamorphic quartzite. This issue has been discussed in geology as well [@howard05], and the definition hence varies somewhat between authors. Visual characterization of quartzite on a megascopic level is typically unreliable, and microscopic analysis is recommended for identification of subtypes based on metamorphic grade, but Howard  also emphasises the need for field-based methodologies. 

In recent years there has been increased development of petrographic characterization of quartzite using destructive methods [e.g. @blomme_etal12; @cnudde_etal12; @dalpra_pitblado16; @prieto_etal19; @prieto_etal20]. These have had success in distinguishing between different groups of quartzite types, allowing for more meaningful studies into quartzite-based resource management strategies. In archaeology there are times, however, when destructive techniques simply are not applicable. Artefact collections (museum, private, etc.) represent a valuable resource, as well as one of the easier ways of gaining access to large datasets with some geographical distribution. While destructive methods may prohibit access to such material there are still non-destructive methods that can generate valuable information. The use of spectroscopy in petrographic characterization is not new, but it is often applied in conjunction with thin-section analysis [e.g. @blomme_etal12; @prieto_etal20]. A major advantage of spectroscopy, however, is that it is both non-destructive and feature fast measurements, making it an attractive alternative for field-based screening purposes. While X-Ray Fluorescence (XRF) is the go-to spectroscopic technique for petrographic characterization [@shackley11; @tykot03], due to its capability of quantifying the elemental content of a material, there are other instrumentations that may provide a deeper insight into the structural properties. Near Infrared spectroscopy (NIRS) goes almost as far back as the XRF @hunt77, and there is an impressive body of work dedicated to the fingerprinting of geological materials [@linderholm_geladi14a; @linderholm_geladi14b; @sciuto19]. The same can be said for Raman spectroscopy, which also has been applied extensively in the Cultural Heritage sector and the analysis of artwork and manuscripts (REF).   

In the current study a dataset of quartzite artefacts from museum collections in Västerbotten, Sweden, have been analysed using the three above mentioned spectroscopic instrumentations (NIRS, Raman, XRF). They all provide different information on the structure and composition of the material and will be evaluated in regards to the different features they record, the observed material groupings, and potential for analysis into joint relations. 


# Material
```{r select-point-data}
#Filter data to focus on quartzite points, point fragments and preforms made from quartz/quartzite materials
Points2 <-
  samples %>%
  filter(material == "Quartz" | material == "Quartzite" | material == "Breccie quartz" | material == "Breccie quartzite" | material  == "Felsitic porphyric quartz",
         type == "Point" | type == "Point fragment" | type == "Preform")

#Reorder factor levels
Points2$type <-
  factor(Points2$type, levels=c("Preform", "Point fragment", "Point"))
```

```{r sample-count, results='hide'}
#Count number of unique rows in sample ID column for the total number of analysed artefacts
tot_samples <- 
  samples %>% 
    filter(type != "Reference") 

tot_uniq <- 
  unique(tot_samples$sample_id)

#Count number of unique rows in sample ID column for the number of points/preforms included in analysis
sample_uniq <- 
  unique(Points2$sample_id)
```

The current study is based on spectroscopic surface measurements on quartzite points found within the County of Västerbotten, Sweden. A dataset of `r length(sample_uniq)` points, point fragments and preforms made from quartz/quartzite material stored at the collections at Västerbotten and Skellefteå museums were analysed using three different spectroscopic instrumentations (Appendix XX). The colour of the material has a mainly black (N1-N3), grey or white (N9) hue, as well as opaque and almost translucent material with a beige tint. A number of these points have, according to prior classifications, been worked using bifacial technology. While there currently is no local chronology available for this artefact type in the North Swedish region, previous research suggest they were in use during the 4 000 – 2 000 BP period [@forsberg85; @forsberg89; @mjaerum12]. Similarly, early studies of raw material use at sites dating to this period seems to indicate an increase in use of quartzite compared to previous periods [@baudou78]. 

A large portion of the collections stored at North Swedish museums were recovered from excavations and surveys performed in conjunction with the river regulations during the 1940s – 1980s [@biornstad06; @janson_hvarfner60], as well as subsequent follow-up survey projects [e.g. @andersson15]. This has likely had a contributing factor to the distribution pattern of the artefacts observed in \@ref(fig:distribution-map) as the known sites with finds of points and preforms are concentrated around the parishes of Dorotea, Lycksele, Vilhelmina and Tärnaby. This can be seen more clearly in the bar graph in \@ref(fig:distribution-by-parish) with the four parishes accounting for almost ¾ of the total no. of samples. 

Västerbotten museum have come far in their digitization effort, making large portions of their collections searchable. Based on a query of all points labelled as ‘quartz’, ‘brecciated quartz’ or ‘quartzite’ a list was generated from their database. Sampling of this pool of artefacts was not random, and based on geographical distribution, in an effort to include as many artefacts as possible from areas with few finds available, such as along the Vindel river. None of these were from the northernmost Skellefte river, however, and thus a selection of 5 artefacts each from three well-known sites stored at the collections of Skellefte museum were included. This resulted in a total dataset of `r length(tot_uniq)` artefacts, and after documentation and looking up missing information, `r length(sample_uniq)` of these were determined to be either points or preforms made from quartz/quartzite material.    

```{r distribution-map, fig.cap="White) Sites with measured samples in the County of Västerbotten; Black) Parish centroid for measured samples lacking site coordinates. Made with Lantmäteriet (CC0), Natural Earth, and Riksantikvarieämbetet.", fig.width=15, fig.height=15, fig.fullwidth=TRUE}
knitr::include_graphics('C:/Users/masj0062/Documents/DOKTORANDSPROJEKT/VERSION CONTROL/MethodPaper/analysis/figures/Distribution.jpeg')
```

```{r distribution-by-parish, fig.cap= paste("Distribution of the", length(sample_uniq), "points and preforms across parishes in Västerbotten, Sweden."), fig.width=12, fig.height=10, fig.fullwidth=TRUE}
#Stacked bar chart with counts of samples per parish and type
ggplot(Points2, aes(x= fct_rev(parish), fill = type)) +
  geom_bar() +
  theme_minimal() +
  labs(y = "Count",
       fill = "Type") +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 16, face = "bold"),
    legend.text = element_text(face = "bold"),
    axis.title.y=element_blank(),
    axis.text.y = element_text(size = 10, face = "bold", colour = "black"),
    axis.title.x = element_text(size = 12, face = "bold", colour = "black")) +
  scale_fill_jco() +
  coord_flip() +
  geom_text(stat ='count', aes(group = parish, label = ..count..), hjust = -0.5)

```

While parts of the collections at Västerbotten museum have been petrographically analysed by a geologist [@biornstad68; @ahman67], at this point it is difficult to say with any certainty how many (if any) of the artefacts in the current dataset were among these. It is fair to assume that the vast majority have been classified visually based on megascopic features according to a “standard” archaeological nomenclature. In the dataset the four main types of registered materials are: quartz, quartzite, brecciated quartz, and brecciated quartzite ^[Original Swedish terms are ‘brecciekvarts’/’brecciekvartsit’ , the latter possibly a spelling mistake]. Those that had no prior material classification registered were sorted into either the quartz or quartzite category. The reason for including ‘quartz’ in the study is in order to test whether it is possible to separate quartz from quartzite using these methods, as well as a way to account for potential mistakes in the original classification.

Another reason for keeping a ‘quartz’ category is the group referred to as ‘brecciated quartz’. In a petrographic study of the artefacts recovered along the Ume river valley Åhman (1967:8) briefly touches upon the definition of ‘brecciated quartz’, also referring to it as a ‘mylonite quartz’. Åhman describes the material as having formed from a quartz vein which has fractured due to movements in the mountain massives and recrystallized via pressure. While the translucent material may give the impression of an unusually pure quartzite, Åhman states that the thin-section analysis reveals the fragmented configuration of quartz. ‘Brecciated quartz’ is a somewhat common term used in North Swedish archaeology, and has typically been used to identify a certain translucent type of fine-grained, quartz-rich material [e.g. @holm91]. 


# Methods
All measurements were performed at the Environmental Archaeology Lab at Umeå University using three different instrumentations; NIRS, Raman scattering, and XRF. The analysis was conducted in a dark room in order to minimize light pollution, with the main light sources in the room being the computer screens. Each artefact was measured twice on different sides, with additional measurements in cases where sampling was difficult. The only exception to this was the XRF, where due to time constraints one measurement was collected as a rule apart from a few exceptions. This lowers the statistical reliability of the XRF analysis and inferences of the results should be evaluated with this in mind. The size of the dataset alleviates some of these issues, as for the larger sites there are multiple objects that likely were made from the same material, however, for the smaller sites there still remains some uncertainties.  
Pre-processing of the spectra is different for each instrumentation and based on relevant literature. After pre-processing the data was modelled using Principal Component Analysis (PCA), which is an unsupervised exploratory technique for reducing the dimensionality of the dataset (Geladi and Linderholm, 2020). PCA modelling was performed using the Prediktera Evince software (www.prediktera.com), which uses the NIPALS algorithm [@bertils19 pp.9-10]. 

## Near Infrared
NIRS measures the absorbance of light within the near infrared region (780 nm – 2 500 nm) of the electromagnetic spectrum. Based on the theory of molecular vibration and excitation [@hunt77], by exposing a geological material to electromagnetic radiation it is possible to generate overtone vibrations which can be related to certain molecular groups. The most common group capable of generating these overtones is the OH group, which in quartz-based materials typically relates to molecular water (REF). 
NIR analysis was conducted with the Analytical Spectral Device (ASD) LabSpec 4, using a contact probe. The ASD features a detection range of 350 – 2500 nm, with spectral sampling (resp. spectral resolution) of 1.4 nm (resp. 3 nm) in the visible and near infrared range and 1.1 nm (resp. 10 nm) in the short‐wave infrared range. Each object was measured against a white reference background. 
Two parts of the NIR spectra was analysed separately, the visual region (400 – 750 nm) and the 1 000 – 2 500 nm region. In both analyses the data was mean-centred before PCA modelling.

## Raman
Raman spectroscopy shares some similarities with NIRS in that they both can be used to infer molecular structure based on their vibrational properties [@nafie01]. However, where NIRS generate overtones of molecular vibration, Raman spectroscopy is based on the ‘Raman scattering’ effect. By exposing a molecule to radiation with a monochromatic laser it is possible to induce a dipole moment in the molecule which generates the Raman effect. The subsequent light that is scattered contains both Rayleigh scatter and Raman scatter, the former at a frequency of incident radiation and the latter at a shifted frequency [@dubessy12]. The spectrometer will measure the Raman scatter and generate a spectrum where the spectral line has shifted compared to the incident Rayleigh frequency. As the structure of a molecule will inform its vibrational mode, the point at which these shifts occur within the infrared region varies depending on the material [@smith_carabatos-nedelec01]. 
The Raman instrumentation used was a portable i-Raman EX featuring a 1064 nm excitation laser. The spectral coverage of the instrumentation is 175 – 2 500 cm-1 with a resolution of 9.5 cm-1. Access to the spectrometer was made possible by the department of Forest Biomaterials and Technology at the Swedish University of Agricultural Sciences (SLU) in Umeå. 
All Raman spectra were baseline corrected using modified polynomial fitting in R (R Core Team, 2017) using the ChemoSpec package [@hanson16]. The spectra were then mean-centred and normalized using Standard Normal Variate (Shaver, 2001: 284-285) in the Prediktera Evince software (www.prediktera.com).

## X-Ray Fluourescence
XRF measurements were collected using a Thermo Scientific Niton XL5 Analyzer, connected to a Thermo ScientificTM portable test stand. The reference calibration used for element quantification was ‘mining’. Sampling with this setting takes 2 minutes in order for the instrument to cycle through all of the filters (main, low, high, light). Due to time constraints and the number of objects in the current dataset it was only possible to collect one measurement on each object, apart from some exceptions. For materials that featured high heterogeneity the sample point was focused, as much as possible, on the surrounding matrix. 
The XRF data was pre-processed using mean-centering, univariate scaling, and log-transformation in the Prediktera Evince software before PCA modelling. 


# Results

## VISNIR

The main explanatory power for the visual region can be found in the first two components, featuring eigenvalues above 1 with a cumulative explained variance of 99.9 %. Plotting these in the score plot there is a clear trend along the first component with darker materials being grouped together to the right of the plot and light/white material to the left (fig. \@ref(fig:vis-nir-pca)). Average spectra of these groups  demonstrate a higher absorbance for the dark group, with both of the light groups featuring higher absorbance in the violet region (fig. \@ref(fig:vis-nir-spectra)). Despite this trend there are exceptions, and while some of these may be material that exist within the muddled greyscale, there are measurements on dark surfaces (N1-N2) that end up closer to the light group (fig.X). There are also instances where the measurements on different sides of an artefact end up in different groups in the PCA. Artefact 403 and 502 both have a sample taken on one side in the ‘dark’ group and the other in the ‘greyish’ middle. This is most likely due to the heterogeneous character of the material and natural variations on the surface possibly related to weathering. The ‘greyish’ middle group is largely made up of ‘quartz coloured’ opaque material with a beige/grey tint (fig.X). 

```{r vis-nir-pca, fig.width=15, fig.height=5, fig.fullwidth=TRUE, fig.cap="PCA score plot of 1st and 2nd components for the 400 nm – 750 nm part of the spectrum. Quartzite with a darker surface group to the right in the model, while white objects group in the bottom left quadrant."}
knitr::include_graphics('C:/Users/masj0062/Documents/DOKTORANDSPROJEKT/VERSION CONTROL/MethodPaper/analysis/figures/VNIR_PCA_p1_p2_center_20210818.jpg')
```

```{r vis-nir-spectra, fig.width=15, fig.height=5, fig.fullwidth=TRUE, fig.cap="Average spectra for dark and light groups in the 400 - 750 nm region"}
knitr::include_graphics('C:/Users/masj0062/Documents/DOKTORANDSPROJEKT/VERSION CONTROL/MethodPaper/analysis/figures/vis_nir_average_spectra_20210702.png')
```
## NIR
No distinct peaks occurred in the 600 – 1 000 nm region, and thus the analysis focused on the 1 000 – 2 500 nm region to lessen the impact of noise. The PCA demonstrates a similar pattern to the one observed in the visual region (fig. \@ref(fig:nir-pca)). Again the first two components have an eigenvalue above 1 with cumulative explained variance of ~99.9 %. While the darker materials remain closely grouped in the right side of the score plot, the ‘light’ cluster seems to split into two separate groups. The upper left group houses the main bulk of the ‘brecciated quartz’, as well as the almost translucent and opaque material with a beige tint. The bottom left group instead features the majority of the white ‘quartz-coloured’ material. In the case of NIRS most features relate to the presence of molecular water in the material [@hunt77; @sciuto_etal19], these mainly occur at around 1 400 nm and 1 900 nm. In some of the material peaks also occur at 2 200 nm and 2 350 nm, where the former can be related to combination vibrations of Al-OH and the latter possibly CO3 [@clark_etal90]. 
The average spectra for the three groups shows that the ‘dark’ group has the highest absorbance with less distinct peaks, although they are noticeable. The absorbance in the ‘brecciated’/translucent group is slightly higher in the lower band regions than compared to the ‘white’ group, but with decreased absorbance in the higher regions. While the 2 450 nm peak can be difficult to discern in most cases, the average spectra for both the ‘brecciated’/translucent group and ‘white’ group feature the other four peaks.

```{r nir-pca, fig.width=15, fig.height=5, fig.fullwidth=TRUE, fig.cap="PCA score plot of light absorbance in 1 000 - 2 500 nm region"}
knitr::include_graphics('C:/Users/masj0062/Documents/DOKTORANDSPROJEKT/VERSION CONTROL/MethodPaper/analysis/figures/NIR_PCA_p1_p2_center_20210818.jpg')
```

## Raman
There are two distinctive features present in the Raman data. The first can be identified as the ‘quartz’ peak occurring at 460 cm-1 [@gillet_etal90], which is present for all samples in the dataset. The second feature shows up as two peaks occurring at around 1 300 cm-1 and 1 600 cm-1, and dominate the spectra in terms of intensity for the darker samples. These peak positions fall within what is referred to as the D and G band respectively, and have been observed in spectroscopic studies of graphite/graphene [@cesare_maineri99]. The D band occurs as a result of disordered carbon structures whilst the G band is caused by stretching in the carbon bonds, which is common to graphite-based materials [@vollebregt_etal12; @lee_etal21].  
The PCA model (fig.X) shows a clear trend along the first component (75.9 %) related to the above two features. The measurements with mainly quartz peaks gravitate towards the positive side of the 1st component, and those where the graphite peaks are dominant towards the opposite side. It is also clear that the darker material feature more pronounced graphite peaks, whereas the lighter and more translucent objects mainly feature quartz peaks. As in the case of the NIR data, however, there are exceptions that break this trend, as well as a “muddled” middle group with both well-pronounced graphite and quartz peaks. 
The 2nd component (7.82 %) mainly seems to differentiate the measurements that feature a lot of noise and objects that were difficult to sample. The same is true for the 3rd component, although it does not seem to be as susceptible to noise as the 2nd component. The 3rd component also separates out samples with irregular readings that could possibly be related to sampling issues on surfaces that were difficult to sample.  

## XRF
The XRF spectrometer is not capable of detecting all of the common elements, and the software therefore calculates a balance (Bal), which represents the remaining unquantifiable elements in a sample. The elements represented in this unquantifiable group are all those with an atomic number lower than 12Mg (REF). The statistics of the balance for this dataset can be seen in table 1, and the results for the calculated estimates in figure X.  
Univariate analysis shows that SiO2 makes up the main bulk of the composition of the material, and two major groups can be distinguished based on this content \@ref(fig:xrf-violin-plot). The majority of the readings resulted in a SiO2 content of less than 50%, and about ¼ of the readings (~ 27%) featured a SiO2 content closer to 90 %. The “low” SiO2 group also feature a Bal between 40 – 70 %. 

```{r xrf-violin-plot, fig.width=15, fig.height=15, fig.fullwidth=TRUE, fig.cap="Violin plot of element content in quartzite samples measured using pXRF. n represents no. of measurements above Limit of Detection (LOD) for that element out of a total of 478 measurements. Note the bimodal distribution of Si measurements, these groups are reflected in the score plot of the PCA"}

#Make long version of Points df to prep for violin plots
Points_long <-
  Points %>%
  select(X12Mg,X13Al, X14Si, X15P, X16S, X19K, X20Ca, X23V, X25Mn, X26Fe, X30Zn, X38Sr, X39Y, X40Zr, X56Ba, X81Ti) %>%
  gather(key = "Element", value = "Value")



#Filter long df to focus on Mg, and generate a violin plot
Mg <-
  Points_long %>%
  filter(Element == "X12Mg") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="salmon1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X12Mg))))) +
  theme_bw() +
  ylim(0,5) +
  xlab("Mg") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on Al, and generate a violin plot
Al <-
  Points_long %>%
  filter(Element == "X13Al") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="lightgoldenrod1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X13Al))))) +
  theme_bw() +
  ylim(0,10) +
  xlab("Al") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on Si, and generate a violin plot
Si <-
  Points_long %>%
    filter(Element == "X14Si") %>%
      ggplot(aes(x=Element, y=Value)) +
      geom_violin(fill="lightgoldenrod1") +
      ggtitle(paste("n = ", length(which(!is.na(Points$X14Si))))) +
      theme_bw() +
      ylim(10,100) +
      xlab("Si") +
      theme(
        axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
        plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
        axis.title.y=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())

#Filter long df to focus on P, and generate a violin plot
P <-
  Points_long %>%
  filter(Element == "X15P") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="lightgoldenrod1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X15P))))) +
  theme_bw() +
  ylim(0,2) +
  xlab("P") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on S, and generate a violin plot
S <-
  Points_long %>%
  filter(Element == "X16S") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="lightgoldenrod1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X16S))))) +
  theme_bw() +
  ylim(0,2.5) +
  xlab("S") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on K, and generate a violin plot
K <-
  Points_long %>%
  filter(Element == "X19K") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="salmon1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X19K))))) +
  theme_bw() +
  ylim(0,10) +
  xlab("K") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on Ca, and generate a violin plot
Ca <-
  Points_long %>%
  filter(Element == "X20Ca") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="salmon1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X20Ca))))) +
  theme_bw() +
  ylim(0,1) +
  xlab("Ca") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on V, and generate a violin plot
V <-
  Points_long %>%
  filter(Element == "X23V") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="skyblue1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X23V))))) +
  theme_bw() +
  ylim(0,0.05) +
  xlab("V") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on Mn, and generate a violin plot
Mn <-
  Points_long %>%
  filter(Element == "X25Mn") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="skyblue1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X25Mn))))) +
  theme_bw() +
  ylim(0,0.75) +
  xlab("Mn") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on Fe, and generate a violin plot
Fe <-
  Points_long %>%
  filter(Element == "X26Fe") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="skyblue1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X26Fe))))) +
  theme_bw() +
  ylim(0,2) +
  xlab("Fe") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on Zn, and generate a violin plot
Zn <-
  Points_long %>%
  filter(Element == "X30Zn") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="skyblue1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X30Zn))))) +
  theme_bw() +
  ylim(0,0.05) +
  xlab("Zn") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on Sr, and generate a violin plot
Sr <-
  Points_long %>%
  filter(Element == "X38Sr") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="salmon1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X38Sr))))) +
  theme_bw() +
  ylim(0,0.02) +
  xlab("Sr") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on Y, and generate a violin plot
Y <-
  Points_long %>%
  filter(Element == "X39Y") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="skyblue1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X39Y))))) +
  theme_bw() +
  ylim(0,0.01) +
  xlab("Y") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on Zr, and generate a violin plot
Zr <-
  Points_long %>%
  filter(Element == "X40Zr") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="skyblue1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X40Zr))))) +
  theme_bw() +
  ylim(0,0.1) +
  xlab("Zr") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on Ba, and generate a violin plot
Ba <-
  Points_long %>%
  filter(Element == "X56Ba") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="salmon1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X56Ba))))) +
  theme_bw() +
  ylim(0,0.5) +
  xlab("Ba") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#Filter long df to focus on Ti, and generate a violin plot
Ti <-
  Points_long %>%
  filter(Element == "X81Ti") %>%
  ggplot(aes(x=Element, y=Value)) +
  geom_violin(fill="lightgoldenrod1") +
  ggtitle(paste("n = ", length(which(!is.na(Points$X81Ti))))) +
  theme_bw() +
  ylim(0,1.5) +
  xlab("Ti") +
  theme(
    axis.title.x = element_text(size = 10, face = "bold", colour = "black"),
    plot.title = element_text(size=10, face = "bold", colour = "black", margin = margin(t = 10, b = -20), vjust=0.02, hjust=0.01),
    axis.title.y=element_blank(),
    axis.text.x=element_blank(),
    axis.ticks.x=element_blank())

#16 figures arranged in 4 rows and 4 columns
grid.arrange(Mg,Al,Si,P,S,K,Ca,V,Mn,Fe,Zn,Sr,Y,Zr,Ba,Ti,ncol=4)
```

The three first components of the PCA have an eigenvalue above 1 and the cumulative explained variance is ~ 86.5%. The loadings of the three components can be seen in figure X. In the score plot of P1 and P2, two large clusters emerges (fig.X). The loadings for 13Al, 18Sr, 19K, 20Ca, 40Zr, 81Ti group together in the top right quadrant whilst 12Mg, 14Si, 15P, 16S, 23V, and 56Ba group in the bottom right. As seen in figure X, 26Fe is the only element positioned on the left side of the model. Interestingly, the left cluster contains the samples with lower 14Si values and the right cluster the higher values. These clusters still remain if you were to exclude 14Si from the model, however, suggesting there are other elements of relevance to the clustering. The “low 14Si” cluster shows a trend along P2 of quartzite with a darker hue grouping towards the top. This may indicate a possible relation to the 26Fe content of the material, as a darker hue may be the result of inclusions of hematite, or possibly biotite. 13Al follows a similar trend with higher values recorded at the top of the two clusters. 
The ‘brecciated quartz’ samples largely group together at the bottom of the “low 14Si” cluster, with a couple ending up towards the bottom of the “high 14Si” cluster. The white (N9) material is somewhat evenly distributed within the leftmost cluster. 
The group of measurements that are somewhat separated from the “low 14Si” cluster at the top are all but one from the rock painting site of ‘Finnforsberget’, which is located next to the Skellefte river. The ‘Finnforsberget’ artefacts were sampled twice with object 491 having one measurement closer to the “low 14Si” group and the other the “high 14Si” group with 13Al estimated at 25 %. This artefact was sampled twice on each side, resulting in similar results both times.
One almost translucent sample also ends up among the darker material. Upon closer inspection this sample is extremely small, 3 by 1 mm, and also feature inclusions of dark particles. Both of these factors may have contributed to its placement in the model.

```{r xrf-loadings, fig.width=8, fig.height=8, fig.fullwidth=TRUE, fig.cap="The three first loading vectors (P1-P3) with scores for each loading (element)"}
#Prepare plots for 3-plot bargraph figure of loadings
#PC1 loadings
P1 <-
  ggplot(loadings, aes(x = fct_rev(Element), y = P1)) +
    geom_bar(
      stat = "identity", position = "identity",
      color = "black", fill = "darkgrey") +
  theme_minimal() +
  theme(plot.margin = margin(10,10,10,10),
        axis.title.y=element_blank(),
        axis.text.y = element_text(size=14, face="bold", colour = "black"),
        axis.title.x = element_text(size = 14, face = "bold", colour = "black")) +
  coord_flip()
#PC2 loadings
P2 <-
  ggplot(loadings, aes(x = fct_rev(Element), y = P2)) +
  geom_bar(
    stat = "identity", position = "identity",
    color = "black", fill = "darkgrey") +
  theme_minimal() +
  theme(plot.margin = margin(10,10,10,10),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.title.x = element_text(size = 14, face = "bold", colour = "black")) +
  coord_flip()
#PC3 loadings
P3 <-
  ggplot(loadings, aes(x = fct_rev(Element), y = P3)) +
  geom_bar(
    stat = "identity", position = "identity",
    color = "black", fill = "darkgrey") +
  theme_minimal() +
  theme(plot.margin = margin(10,10,10,10),
        axis.title.y = element_blank(),
        axis.text.y = element_blank(),
        axis.title.x = element_text(size = 14, face = "bold", colour = "black")) +
  coord_flip()

#Composite figure of above bar graphs
grid.arrange(P1, P2, P3, ncol=3)
```

```{r xrf-score-plot, fig.cap="Score plot for P1 and P2, the two major groups are distinguished by lower SiO content to the left and higher to the right"}
knitr::include_graphics('C:/Users/masj0062/Documents/DOKTORANDSPROJEKT/VERSION CONTROL/MethodPaper/analysis/figures/XRF_PCA_p1_p2.png')
```

# Discussion
The results demonstrate clearly that all three instrumentations are capable of characterizing some aspect of the quartz and quartzite, however, none of them are capable of providing a detailed fingerprint on their own based solely on surface measurements. Taken together they do provide a more in-depth understanding of the characteristic and structure of the material. The most easily recognizable megascopic feature of the material is its colour, and the results of all three instrumentations demonstrate that there is some 

Interestingly the ‘brecciated quartz’ remains relatively grouped together in all of the models demonstrating some consistency in the original classification. There are exceptions, however, and it would be advisable to follow up with a more directed analysis focused around this group of material……


# Conclusion

# Acknowledgements

<!-- The following line inserts a page break  -->

\newpage

# References 

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

<div id="refs"></div>

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
